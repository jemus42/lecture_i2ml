## Clustering: Customer Segmentation

- In marketing, customer segmentation is an important task to understand customer needs and to meet with customer expectations.

- Customer data is partitioned in terms of similiarities and the characteristics of each group are summarized.

- Marketing strategies are designed and prioritized according to the group size.

Example Use Cases:

- Personalized ads (e.g., recommend articles).
- Music/Movie recommendation systems.

<!-- # ML Use Cases: Clustering -->

<!-- - Initially define number of groups that are expected to have.  -->

<!-- - Each data point is assigned to cluster centers and new cluster centers are calculated. -->

<!-- - Iterative process is completed when the cluster centers converge/no significant change in cluster centers observed.  -->


## Clustering: Image Compression

```{r, include = FALSE, echo = FALSE, message = FALSE} 
ap = adjust_path(paste0(getwd(), "/figure"))
```

- An image consists of pixels arranged in rows and columns.
- Pixels contain color information, which can be represented by the RGB color space, a mix of 3 colors (**R**ed, **G**reen and **B**lue).
- The 3 colors (RGB) can be mixed with different intensities ranging from 0 to 255 to produce.

\begin{center}
\includegraphics[width=0.45\textwidth]{`r ap("rgb-cube.png")`}

\tiny Source: By Ferlixwangg \href{https://creativecommons.org/licenses/by-sa/4.0}{CC BY-SA 4.0}, from \href{https://commons.wikimedia.org/wiki/File:Rgb-cube.gif}{Wikimedia Commons}.
\end{center}


## Clustering: Image Compression

An image can be compressed by reducing its color information, i.e., by replacing similar colors of each pixel with, say, $k$ distinct colors.

**Example**: 

```{r, echo = FALSE, fig.height=5, fig.width=10}
library(jpeg)

img = readJPEG(ap("colorful_bird.jpg")) # Read the image
imgDm = dim(img)
# We re-arranged the 3D array into a dataset that has the coordinates of the pixel and the color information (R, G and B)
imgRGB = data.frame(
  x = rep(1:imgDm[2], each = imgDm[1]),
  y = rep(imgDm[1]:1, imgDm[2]),
  R = as.vector(img[,,1]),
  G = as.vector(img[,,2]),
  B = as.vector(img[,,3])
)

par(mfrow = c(1,2), mar = c(0,0,2,0))
# We now plot the pixels (pch = 15) with its RGB color info
plot(imgRGB$x, imgRGB$y, col = rgb(imgRGB[c("R", "G", "B")]), pch = 15, axes = F, main = "Original Image", xlab = "", ylab = "")
box()

k = 16
kMeans = kmeans(imgRGB[, c("R", "G", "B")], centers = k)
predRGB = kMeans$centers[kMeans$cluster,]

plot(imgRGB$x, imgRGB$y, col = rgb(predRGB), pch = 15, axes = F, main = "Image using 16 Colors", xlab = "", ylab = "")
box()
```

