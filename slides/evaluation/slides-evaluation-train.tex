% Defines macros and environments
\input{../../style/preamble}
\input{../../latex-math/basic-math.tex}
\input{../../latex-math/basic-ml.tex}


\newcommand{\titlefigure}{figure/eval_train_2}
\newcommand{\learninggoals}{
\item Understand the definition of training error
\item Understand why training error is no reliable estimator of future performance
}
\title{Introduction to Machine Learning}
% \author{Bernd Bischl, Christoph Molnar, Daniel Schalk, Fabian Scheipl}
\institute{\href{https://compstat-lmu.github.io/lecture_i2ml/}{compstat-lmu.github.io/lecture\_i2ml}}
\date{}


\begin{document}


%! includes: evaluation-intro 

\lecturechapter{Evaluation: Training Error}
\lecture{Introduction to Machine Learning}

\begin{vbframe}{Training Error}
(also: apparent error / resubstitution error)


\lz

\begin{center}
% FIGURE SOURCE: https://docs.google.com/drawings/d/1m0Uwf5bvWuP1agyZ0TOd0qaBakJVtfe_PspxqPL3mxU/edit?usp=sharing
\includegraphics[width=.55\textwidth]{figure_man/train_error.pdf}
\end{center}

\vspace{-0.8cm}

\end{vbframe}

\begin{vbframe}{Example: Polynomial Regression}

Sample data from sinusoidal function
$0.5 + 0.4 \cdot \sin (2 \pi x) + \epsilon$\\
with measurement error $\epsilon$.

\begin{knitrout}\scriptsize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}

{\centering \includegraphics[width=0.85\textwidth]{figure/eval_train_1} 

}



\end{knitrout}

Assume data-generating process unknown.\\
Try to approximate with a $d^{th}$-degree polynomial:
\[ \fxt = \theta_0 + \theta_1 x + \cdots + \theta_d x^d = \sum_{j = 0}^{d} \theta_j x^j\text{.} \]

\framebreak

Models of different \textit{complexity}, i.e., of different orders of the polynomial
are fitted. How should we choose $d$?

\begin{knitrout}\scriptsize
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}

{\centering \includegraphics[width=0.7\textwidth]{figure/eval_train_2} 

}



\end{knitrout}

\begin{itemize}
\item d=1: MSE = 0.036: Clear underfitting
\item d=3: MSE = 0.003: Pretty OK?
\item d=9: MSE = 0.001: Clear overfitting
\end{itemize}

Simply using the training error seems to be a bad idea.

\end{vbframe}

\begin{vbframe}{Training Error Problems}
\begin{itemize}
  \item Unreliable and overly optimistic estimator of future performance.
    E.g., training error of 1-NN is always zero as each observation is its own NN during test time.
  \item Goodness-of-fit measures like (classic) $R^2$, likelihood, AIC, BIC, deviance are all based on the training error.
  \item For models of restricted capacity, and given enough data, the training error may provide reliable information.\\ 
  E.g., LM with $p = 5$ features, $10^6$ training points.\\ 
  But: impossible to determine when training error becomes unreliable.
\end{itemize}
\end{vbframe}

\endlecture
\end{document}
