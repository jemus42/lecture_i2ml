
\documentclass[11pt,compress,t,notes=noshow, xcolor=table]{beamer}
\input{../../style/preamble}
\input{../../latex-math/basic-math.tex}
\input{../../latex-math/basic-ml.tex}

\newcommand{\titlefigure}{slides/forests/figure_man/nutshell-randomforest-random-split.png}

\newcommand{\learninggoals}{
\item Understand basic concept of random forest
\item Know basic aggregation rules
\item Understand concept of feature importance
}

\title{Introduction to Machine Learning}
% \author{Bernd Bischl, Christoph Molnar, Daniel Schalk, Fabian Scheipl}
\institute{\href{https://compstat-lmu.github.io/lecture_i2ml/}{compstat-lmu.github.io/lecture\_i2ml}}
\date{}

\begin{document}
\lecturechapter{Random Forest: In a Nutshell}
\lecture{Introduction to Machine Learning}

% ------------------------------------------------------------------------------

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%% L2
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{vbframe}{Learning and Prediction with RF}
\begin{itemize}
\item \small Stabilizes tree learner by bagging (bootstrap aggregation)
\item \small Randomizes tree learner and combines models into one meta model
\item \small Can be adapted to learning task, i.e., classification or regression
\end{itemize}

\begin{columns}  
\begin{column}{0.1\textwidth} 
\begin{center}
\vspace{2.2cm}
Training
\end{center}
\end{column}
\begin{column}{0.9\textwidth} 
\begin{center}
%https://docs.google.com/presentation/d/1y5E3s9xQLjcJWPL3zllrldjHtuonyhEP/edit#slide=id.p1
  \includegraphics[width = 1\textwidth]{slides/forests/figure_man/nutshell-randomforest-learning.png}
\end{center}
\end{column}
\end{columns}
\end{vbframe} 

\begin{vbframe}{Learning and Prediction with RF}
\begin{columns}
\begin{column}{0.05\textwidth} 
\begin{center}
\vspace{0.7cm}
Prediction
\end{center}
\end{column}
\begin{column}{0.95\textwidth} 
\begin{center}
%https://docs.google.com/presentation/d/13rYrVvmecOc8pePPsOcQtAzy9cJZk3m4/edit#slide=id.p1
  \includegraphics[width = 0.6\textwidth]{slides/forests/figure_man/nutshell-randomforest-prediction.png} 
\end{center}
\end{column}
\end{columns}

\end{vbframe} 

% ------------------------------------------------------------------------------

\begin{vbframe}{Aggregation rules for different tasks}
\begin{columns}  
\begin{column}{0.5\textwidth} 
\begin{center}
%https://docs.google.com/presentation/d/1XrGkql56NxQsAI5XNNonmzfsTWlKWAok/edit#slide=id.p1
 \includegraphics[width = 1\textwidth]{slides/forests/figure_man/nutshell-randomforest-aggregation-classif.png}
 \end{center}
\end{column}
\begin{column}{0.5\textwidth} 
\begin{center}
%https://docs.google.com/presentation/d/1Ta22VthQmGVshGoC3JAGEfKYPK46RHcB/edit#slide=id.p1
  \includegraphics[width = 1\textwidth]{slides/forests/figure_man/nutshell-randomforest-aggregation-regression.png}
\end{center}
\end{column}
\end{columns}



\end{vbframe}

% ------------------------------------------------------------------------------

\begin{vbframe}{Performance of RF}
\begin{itemize}
\item \small In general: Increasing the ensemble size stabilizes the predictions
    \begin{itemize}
        \item \small For regression tasks the stabilization is often not sufficient. 
    \end{itemize}

\end{itemize}
\begin{columns}  
\begin{column}{0.5\textwidth} 
\begin{center}
 \includegraphics[width = 1\textwidth]{slides/forests/figure/nutshell_forest_ensemblesize_1.pdf}
 \end{center}
\end{column}
\begin{column}{0.5\textwidth} 
\begin{center}
  \includegraphics[width = 1\textwidth]{slides/forests/figure/nutshell_forest_ensemblesize_3.pdf}
\end{center}
\end{column}
\end{columns}

\end{vbframe}

\begin{vbframe}{Performance of RF}
\begin{itemize}
    \begin{itemize}
        \item \small RF performs well for classification tasks:
        \begin{itemize}
            \item \small Two different trees \textrightarrow Two different decision regions
            \item \small Two different RFs \textrightarrow Same decision regions
        \end{itemize}
    \end{itemize}
\begin{center}
 \includegraphics[width = 0.6\textwidth]{slides/forests/figure/nutshell_classif_combined_1.pdf}
\end{center}
\end{itemize}



\end{vbframe}

\begin{vbframe}{Performance of RF}
\begin{itemize} 
\item \small Trees should be decorrelated, i.e., make mistakes in different directions
\item \small Avoid correlation by
    \begin{itemize}
        \item \small Bootstrap sampling 
        \item \small Randomized splits. In each node of each tree, consider different features for splitting:
    \end{itemize}
\end{itemize}

\vspace{0.5cm}
\begin{center}
%https://docs.google.com/presentation/d/1rJZbyGoX4I9RFKO9VbetJxZX4o9dy_aZ/edit#slide=id.p1
  \includegraphics[width = 0.6\textwidth]{slides/forests/figure_man/nutshell-randomforest-random-split.png}
\end{center}




\end{vbframe}

% ------------------------------------------------------------------------------

\begin{vbframe}{feature importance}
% Two ways for measuring feature importance
\begin{itemize}
\item \small Measure contributions of different features to the model:
    \begin{itemize}
        \item \small Measure based on improvement in splitting criterion
        \item \small E.g. Feature importance of 'Health', search all nodes with 'Health' as splitting variable:
    \end{itemize}
\end{itemize}    


%https://docs.google.com/presentation/d/1ApCeEQsttK47pUyTkeJMhaxbBxyUX9YD/edit#slide=id.p1
\includegraphics[width = \textwidth]{slides/forests/figure_man/nutshell-random-forest-feature-importance_split.png}
\end{vbframe}

\begin{vbframe}{FEATURE IMPORTANCE}
\begin{itemize}
    \item \small Measure based on permutations of OOB obs (observations not included in bootstrap sample)
    \item \small Difference between loss of permuted-model prediction and original model prediction
\end{itemize}


\begin{center}
%https://docs.google.com/presentation/d/1HEZcKzK3mkxyBFXAO5PExgbAuRQr9UQW/edit#slide=id.p1
    \includegraphics[width = 0.75\textwidth]{slides/forests/figure_man/nutshell-randomforest-OOB_1.png}
\end{center}

\end{vbframe}


\begin{vbframe}{FEATURE IMPORTANCE}
\begin{center}
%https://docs.google.com/presentation/d/1vvbTcxAIbONs8oxll6rNzVB_9Q8KzcP9/edit#slide=id.p1
    \includegraphics[width = 0.75\textwidth]{slides/forests/figure_man/nutshell-randomforest-OOB_2.png}
\end{center}

\vspace{0.5cm}
\begin{center}
Feature Importance = OOB Loss Health Permuted - OOB Loss Health
\end{center}
\end{vbframe}


% ------------------------------------------------------------------------------


\endlecture
\end{document}