\input{../../style/preamble}
\input{../../latex-math/basic-math}
\input{../../latex-math/basic-ml}

\newcommand{\titlefigure}{figure_man/roc-confusion_matrix.png}
\newcommand{\learninggoals}{
  \item \textcolor{blue}{XXX}
  \item \textcolor{blue}{XXX}
}

\title{Introduction to Machine Learning}
\date{}
\begin{document}

\lecturechapter{Precision-Recall Curves}
\lecture{Introduction to Machine Learning}

\begin{vbframe}{Precision-Recall Curves}

%\textbf{Motivation}: ROC curves should mainly be used in binary classification problems.
\begin{footnotesize}
When dealing with highly imbalanced data (i.e., $\nn \gg \np$), precision-recall (PR) curves may be more useful than ROC curves:
% of an algorithms performance.

\begin{itemize}
  \item Precision = $\frac{TP}{TP + FP}$, recall = TPR = $\frac{TP}{TP + FN}$ (do not depend on TN).
  %\item Note that both measures are not dependent on true negatives.
  \item Figure (a): ROC curve shows that both algorithms perform well.
  \item Figure (b): PR curve shows that there is room for improvement (optimum PR curve: top-right corner).
  \item The PR space reveals that algorithm 2 has an advantage over algorithm 1, which is due to imbalanced classes.
\end{itemize}
\end{footnotesize}
\begin{figure}
    \centering
    \scalebox{0.75}{\includegraphics{figure_man/roc-pr.png}}
    \tiny{\\ Credit: Jesse Davis and Mark Goadrich \\}
\end{figure}
{\tiny{Davis and Goadrich (2006): The Relationship Between Precision-Recall and ROC Curves. \emph{\url{https://www.biostat.wisc.edu/~page/rocpr.pdf}}}\par}
% Source: http://people.cs.bris.ac.uk/~flach/ICML04tutorial/ROCtutorialPartI.pdf
%\tiny{Source for material: https://www.biostat.wisc.edu/~page/rocpr.pdf}
%\tiny{Source for material: https://towardsdatascience.com/what-metrics-should-we-use-on-imbalanced-data-set-precision-recall-roc-e2e79252aeba}
%\tiny{Source for material: https://machinelearningmastery.com/roc-curves-and-precision-recall-curves-for-classification-in-python/}
%\tiny{Source 6: http://binf.gmu.edu/mmasso/ROC101.pdf}
% Source: https://link.springer.com/content/pdf/10.1007/s10994-006-8199-5.pdf

\framebreak

\begin{itemize}
  \item The issue with ROC is the FPR in case of $\nn \gg \np$, which is often very small as the TN are usually high. \newline
  $\Rightarrow$ A large change in FP yields a small change in the FPR.
  \item Precision: compares FP to TP (not TN) and does not suffer from this issue.
  It captures the effect of the large $\nn$.
\end{itemize}
\hspace*{\fill}\includegraphics[width=0.6\textwidth]{figure_man/roc-confusion_matrix.png}\hspace*{\fill}

\framebreak

\begin{footnotesize}
\vspace{-0.2cm}
\begin{itemize}
  \item Figures with $\pi = 0.003$ use imbalanced, and with $\pi = 0.5$ balanced classes.
  \item The underlying classifiers and concept remain the same, only the class distribution has changed.
  \item ROC curves in are similar, while the PR curve changes dramatically from imbalanced to balanced classes. 
  %\item Note that the superiority of classifiers in terms of performance can change with a skewed class distribution.
\end{itemize}
\end{footnotesize}
%replaced graph: (too small)
% \begin{figure}
%     \centering
%     \includegraphics[width=\textwidth]{figure_man/roc-pr-all.png}
%     \tiny{\\ Credit: Tom Fawcett \\}
% \end{figure}
% {\tiny{Tom Fawcett (2004): ROC Graphs: Notes and Practical Considerations for Researchers. \emph{\url{http://binf.gmu.edu/mmasso/ROC101.pdf}}}\par}
\vspace{-0.4cm}

\begin{figure}
    \centering
    \scalebox{0.55}{\includegraphics[width=\textwidth]{figure_man/roc-pr-imbalanced.png}}
    \tiny{\\ Credit: Wissam Siblini et. al. \\}
\end{figure}
\vspace{-0.25cm}
{\tiny{Wissam Siblini et. al. (2004): Master your Metrics with Calibration. \emph{\url{https://arxiv.org/pdf/1909.02827.pdf}}}\par}




\framebreak

\textbf{Conclusion}: \\
\begin{itemize}
  \item ROC and PR curves for given algorithms contain the same points.
  %\item A curve that dominates in ROC space iff it dominates in PR space.
  \item Analogous to the convex hull in ROC space, there is a convex hull in PR space (same points omitted as in convex hull in ROC space).
  \item An algorithm that optimizes the ROC-AUC is not guaranteed to optimize
  the PR-AUC.
  \item Use ROC curves when the numbers of samples in both classes are roughly equal.
  \item Use PR curves when there is a moderate to large class
  imbalance and predicting positive instances is more relevant.
\end{itemize}
\end{vbframe}


\endlecture
\end{document}
